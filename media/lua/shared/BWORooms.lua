BWORooms = BWORooms or {}

BWORooms.tab = {

    aesthetic = {
        isShop = true,
    },

    aestheticstorage = {
        isStorage = true,
    },

    armyhanger = {

    },

    armystorage = {
        isStorage = true,
    },

    armysurplus = {
        isShop = true,
    },

    artstore = {
        isShop = true,
    },

    bakery = {
        isShop = true,
    },

    bakerykitchen = {
        isRestaurant = true,
        isKitchen = true,
        occupations = {"chef", "burgerflipper"},
    },

    bandkitchen = {
        isRestaurant = true,
        isKitchen = true,
        occupations = {"chef", "burgerflipper"},
    },

    bandlivingroom = {
        isShop = true,
    },

    bandmerch = {
        isShop = true,
    },

    bank = {
        isShop = true,
        occupations = {"securityguard"},
    },

    bankstorage = {
        isStorage = true,
        occupations = {"securityguard"},
    },

    bar = {
        isRestaurant = true,
    },

    barbecuestore = {
        isShop = true,
    },

    barkitchen = {
        isRestaurant = true,
        isKitchen = true,
        occupations = {"chef", "burgerflipper"}
    },

    barstorage = {
        isStorage = true,
    },

    baseballstore = {

    },

    batfactory = {
        isShop = true,
    },

    bathroom = {
        pop = 0
    },

    batstorage = {
        isStorage = true,
    },

    batteryfactory = {

    },

    batterystorage = {
        isStorage = true,
    },

    bedroom = {

    },

    beergarden = {
        isShop = true,
    },

    bookstore = {

    },

    bowlingalley = {

    },

    breakroom = {

    },

    brewery = {
        isShop = true,
    },

    brewerystorage = {
        isStorage = true,
    },

    burgerkitchen = {
        isRestaurant = true,
        isKitchen = true,
        occupations = {"chef", "burgerflipper"}
    },

    burgerstorage = {
        isStorage = true,
        occupations = {"chef", "burgerflipper"}
    },

    butcher = {
        isShop = true,
    },

    cabinetfactory = {

    },

    cabinetshipping = {

    },

    cafe = {
        isRestaurant = true,

    },

    cafekitchen = {
        isRestaurant = true,
        isKitchen = true,
        occupations = {"chef", "burgerflipper"}
    },

    cafeteria = {
        isRestaurant = true,
    },

    cafeteriakitchen = {
        isRestaurant = true,
        isKitchen = true,
        occupations = {"chef", "burgerflipper"}
    },

    camerastore = {
        isShop = true,
    },

    camping = {
        isShop = true,
    },

    campingstorage = {
        isStorage = true,
    },

    candystorage = {
        isStorage = true,
    },

    candystore = {
        isShop = true,
    },

    carsupply = {
        isShop = true,
    },

    cell = {
        occupations = {"securityguard", "policeofficer"}
    },

    changeroom = {

    },

    chinesekitchen = {
        isRestaurant = true,
        isKitchen = true,
        occupations = {"chef", "burgerflipper"}
    },

    chineserestaurant = {
        isShop = true,
        isRestaurant = true,
    },

    church = {

    },

    classroom = {

    },

    closet = {

    },

    clinic = {
        isShop = true,
        isMedical = true,
    },

    clothesstore = {

    },

    clothesstorestorage = {
        isStorage = true,
    },

    clothingstorage = {
        isStorage = true,
    },

    clothingstore = {
        isShop = true,
    },

    construction = {

    },

    controlroom = {

    },

    conveniencestore = {
        isShop = true,
    },

    cornerstore = {
        isShop = true,
    },

    cornerstorestorage = {
        isStorage = true,
    },

    daycare = {

    },

    deepfry_kitchen = {
        isRestaurant = true,
        isKitchen = true,
        occupations = {"chef", "burgerflipper"}
    },

    dentiststorage = {
        isStorage = true,
        occupations = {"doctor", "nurse"}
    },

    departmentstorage = {
        isStorage = true,
    },

    departmentstore = {
        isShop = true,
    },

    dinerbackroom = {
        isShop = true,
    },

    dinerkitchen = {
        isRestaurant = true,
        isKitchen = true,
        occupations = {"chef", "burgerflipper"}
    },

    dining = {
        isShop = true,
        isRestaurant = true,
    },

    diningroom = {

    },

    dogfoodfactory = {
        isShop = true,
    },

    dogfoodshipping = {
        isShop = true,

    },
    dogfoodstorage = {
        isStorage = true,
    },

    donut_dining = {
        isRestaurant = true,
    },

    donut_kitchen = {
        isRestaurant = true,
        isKitchen = true,
        occupations = {"chef", "burgerflipper"}
    },

    donut_kitchenstorage = {
        isStorage = true,
    },

    dressingrooms = {

    },

    druglab = {

    },

    drugshack = {

    },

    electronicsstorage = {
        isStorage = true,
        occupations = {"electrician"}
    },

    electronicsstore = {
        isShop = true,
    },

    empty = {
        isEmpty = true,
    },

    emptyoutside = {
        isEmpty = true,
    },

    factory = {

    },

    factorystorage = {
        isStorage = true,
    },

    farmstorage = {
        isStorage = true,
    },

    firestorage = {
        isStorage = true,
        occupations = {"fireofficer"}
    },

    fishchipskitchen = {
        isRestaurant = true,
        isKitchen = true,
        occupations = {"chef", "burgerflipper"}
    },

    fishingstorage = {
        isStorage = true,
    },

    fossoil = {
        isShop = true,
        twentyfour = true,
    },

    fryshipping = {
        isShop = true,
    },

    furniturestorage = {
        isStorage = true,
    },

    furniturestore = {
        isShop = true,
    },

    garage = {

    },

    garagestorage = {
        isStorage = true,
    },

    garage_storage = {
        isStorage = true,
    },

    gardenstore = {
        isShop = true,
    },

    gasstorage = {
        isStorage = true,
    },

    gasstore = {
        isShop = true,
        twentyfour = true,
    },

    generalstore = {
        isShop = true,

    },

    generalstorestorage = {
        isStorage = true,
    },

    giftstorage = {
        isStorage = true,
    },

    giftstore = {
        isShop = true,
    },

    gigamart = {
        isShop = true,
    },

    gigamartkitchen = {
        isKitchen = true,
        occupations = {"chef", "burgerflipper"}
    },

    grocery = {
        isShop = true,
    },

    grocerystorage = {
        isStorage = true,
    },

    gunstore = {
        isShop = true,
        occupations = {"veteran"}
    },

    gunstorestorage = {
        isStorage = true,
        occupations = {"veteran"}
    },

    gym = {

    },

    hall = {

    },

    hallway = {

    },

    hospitalstorage = {
        isStorage = true,
        occupations = {"doctor", "nurse"}
    },

    housewarestore = {
        isShop = true,
    },

    house_main = {
        isShop = true,
    },

    house_bedroom = {
        isShop = true,
    },

    house_kitchen = {
        isShop = true,
    },

    house_bathroom = {
        isShop = true,
    },

    hunting = {
        isShop = true,
    },

    icecream = {
        isRestaurant = true,
    },

    icecreamkitchen = {
        isRestaurant = true,
        isKitchen = true,
        occupations = {"chef", "burgerflipper"}
    },

    italiankitchen = {
        isRestaurant = true,
        isKitchen = true,
        occupations = {"chef", "burgerflipper"}
    },

    italianrestaurant = {
        isShop = true,
        isRestaurant = true,
    },

    janitor = {

    },

    jayschicken_dining = {
        isRestaurant = true,
    },

    jayschicken_kitchen = {
        isRestaurant = true,
        isKitchen = true,
        occupations = {"chef", "burgerflipper"}
    },

    jewelrystorage = {
        isStorage = true,
    },

    jewelrystore = {
        isShop = true,
    },

    kennels = {
        isShop = true,
    },

    kitchen = {
        isKitchen = true,
    },

    kitchenstorage = {
        isKitchen = true,
        isStorage = true
    },

    kitchen_crepe = {
        isRestaurant = true,
        isKitchen = true,
        occupations = {"chef", "burgerflipper"}
    },

    kitchenwares = {
        isShop = true,
    },

    knifefactory = {
        isShop = true,
    },

    knifeshipping = {
        isShop = true,
    },

    knifestore = {
        isShop = true,
    },

    laboratory = {

    },

    lasertag = {
        isShop = true,
    },

    laundry = {

    },

    leatherclothesstore = {
        isShop = true,
    },

    library = {
        
    },

    lingeriestore = {
        isShop = true,
    },

    liquorstore = {
        isShop = true,
    },

    livingroom = {

    },

    lobby = {

    },

    locker = {

    },

    lockerroom = {

    },

    loggingfactory = {

    },

    loggingtruck = {

    },

    mapfactory = {

    },

    mechanic = {
        isShop = true,
        occupations = {"mechanic"}
    },

    medclinic = {
        isShop = true,
        isMedical = true,
        occupations = {"doctor", "nurse"}
    },

    medical = {
        isShop = true,
        isMedical = true,
        occupations = {"doctor", "nurse"}
    },

    medicalclinic = {
        isShop = true,
        isMedical = true,
        occupations = {"doctor", "nurse"}
    },

    medicalstorage = {
        isStorage = true,
        occupations = {"doctor", "nurse"}
    },

    meeting = {

    },

    meetingroom = {

    },


    metalshipping = {

    },

    metalshop = {

    },

    mexicankitchen = {
        isRestaurant = true,
        isKitchen = true,
        occupations = {"chef", "burgerflipper"}
    },

    motelroom = {

    },

    motelroomoccupied = {

    },

    morgue = {

    },

    movierental = {
        isShop = true,
    },

    musicstore = {
        isShop = true,
    },

    newspaperprint = {

    },

    newspapershipping = {

    },

    newspaperstorage = {
        isStorage = true,
    },

    office = {

    },

    officestorage = {
        isStorage = true,

    },

    optometrist = {
        isShop = true,
    },

    paintershop = {

    },

    pawnshop = {
        isShop = true,
    },

    pawnshopcooking = {

    },

    pawnshopoffice = {

    },

    pawnshopstorage = {
        isStorage = true,
    },

    pharmacy = {
        isShop = true,
        isMedical = true,
    },

    pharmacystorage = {
        isStorage = true,
        occupations = {"doctor", "nurse"}
    },

    photoroom = {
        isShop = true,
    },

    picnic = {

    },

    pileocrepe = {
        isRestaurant = true,
    },

    pizzakitchen = {
        isRestaurant = true,
        isKitchen = true,
        occupations = {"chef", "burgerflipper"}
    },

    pizzawhirled = {
        isRestaurant = true,
    },

    plazastore1 = {

    },

    policestorage = {
        isStorage = true,
        occupations = {"policeofficer"}
    },

    pool = {

    },

    post = {

    },

    poststorage = {
        isStorage = true,
    },

    potatostorage = {
        isStorage = true,
        occupations = {"farmer"}
    },

    prisoncells = {
        occupations = {"securityguard", "policeofficer"}
    },

    producestorage = {
        isStorage = true,
        occupations = {"farmer"}
    },

    radiofactory = {
        isShop = true,
    },

    radioshipping = {
        isShop = true,
    },

    radiostorage = {
        isStorage = true,
        occupations = {"electrician"}
    },

    recreation = {

    },

    restaurant = {
        isRestaurant = true,
    },

    restaurant_dining = {
        isRestaurant = true,
    },

    restaurantkitchen = {
        isRestaurant = true,
        isKitchen = true,
        occupations = {"chef", "burgerflipper"}

    },

    restaurantstorage = {
        isStorage = true,

    },

    room1 = {

    },

    schoolstorage = {
        isStorage = true,

    },

    seafoodkitchen = {
        isRestaurant = true,
        isKitchen = true,
        occupations = {"chef", "burgerflipper"}
    },

    security = {
        isStorage = true,
        occupations = {"securityguard"}
    },

    sewingstorage = {
        isStorage = true,
    },

    sewingstore = {
        isShop = true,
    },

    shed = {

    },

    shoestore = {
        isShop = true,
    },

    shoestorage = {
        isStorage = true,
    },

    sodatruck = {
        isShop = true,
    },

    spiffo_dining = {
        isRestaurant = true,
    },

    spiffoskitchen = {
        isRestaurant = true,
        isKitchen = true,
        occupations = {"chef", "burgerflipper"}
    },

    spiffosstorage = {
        isStorage = true,
    },

    sportstorage = {
        isShop = true,
    },

    sportstore = {

    },

    storageunit = {

    },

    storage = {
        isStorage = true
    },

    storageclothes = {
        isStorage = true,

    },

    stripclub = {

    },

    sushidining = {
        isRestaurant = true,
    },

    sushikitchen = {
        isRestaurant = true,
        isKitchen = true,
        occupations = {"chef", "burgerflipper"}
    },

    theatre = {

    },

    theatrekitchen = {
        isRestaurant = true,
        isKitchen = true,
        occupations = {"chef", "burgerflipper"}
    },

    theatrestorage = {
        isStorage = true,
    },

    toolstorestorage = {
        isStorage = true,
    },

    toolstore = {
        isShop = true,
    },

    toystore = {
        isShop = true,
    },

    toystorestorage = {
        isStorage = true,
    },

    walletshop = {
        isShop = true,
    },

    warehouse = {
        isStorage = true,
    },

    westernkitchen = {
        isRestaurant = true,
        isKitchen = true,
        occupations = {"chef", "burgerflipper"}
    },

    whiskeybottling = {
        isStorage = true,
    },

    wirefactory = {
        isStorage = true,

    },

    zippeestorage = {
        isStorage = true,
    },

    zippeestore = {
        isShop = true,
    },
}

BWORooms.IsShop = function(room)
    local name = room:getName()
    local data = BWORooms.tab[name]
    if data and data.isShop then 
        return true
    else
        return false
    end 
end

BWORooms.IsRestaurant = function(room)
    local name = room:getName()
    local data = BWORooms.tab[name]
    if data and data.isRestaurant then 
        return true
    else
        return false
    end 
end

BWORooms.IsStorage = function(room)
    local name = room:getName()
    local data = BWORooms.tab[name]
    if data and data.isStorage then 
        return true
    else
        return false
    end 
end

BWORooms.IsMedical = function(room)
    local name = room:getName()
    local data = BWORooms.tab[name]
    if data and data.isMedical then 
        return true
    else
        return false
    end 
end

BWORooms.IsEmpty = function(room)
    local name = room:getName()
    local data = BWORooms.tab[name]
    if data and data.isEmpty then 
        return true
    else
        return false
    end 
end

BWORooms.IsIntrusion = function(room)

    -- available professions types: 
    -- unemployed, fireofficer, policeofficer, parkranger, constructionworker, securityguard, carpenter, burglar, chef, farmer, fisherman
    -- doctor, veteran, nurse, lumberjack, fitnessinstructor, burgerflipper, electrician, metalworker, mechanics
    local player = getPlayer()
    local profession = player:getDescriptor():getProfession()
    local building = room:getBuilding()
    local roomName = room:getName()

    -- instrusions
    local isIntrusion = false
    if BWOBuildings.IsResidential(building) then 
        isIntrusion = true
    end

    if BWORooms.IsStorage(room) then 
        isIntrusion = true
    end

    -- exceptions
    local name = room:getName()
    local tab = BWORooms.tab
    local data = BWORooms.tab[name]
    if data.isStorage then
        if data.occupations then
            for _, occupation in pairs(data.occupations) do
                if profession == occupation then
                    isIntrusion = false
                    break
                end
            end
        end
    end

    if BWOBuildings.IsEventBuilding(building, "party") then 
        isIntrusion = false 
    elseif BWOBuildings.IsEventBuilding(building, "home") then 
        isIntrusion = false 
    elseif BWORooms.IsEmpty(room) then  
        isIntrusion = false 
    elseif BWORooms.IsShop(room) then 
        isIntrusion = false 
    elseif BWORooms.IsRestaurant(room) then 
        isIntrusion = false 
    elseif BWORooms.IsMedical(room) then 
        isIntrusion = false 
    elseif roomName == "church" then 
        isIntrusion = false 
    end

    return isIntrusion
end

BWORooms.TakeIntention = function(room)
    local canTake = false
    local shouldPay = false

    local building = room:getBuilding()

    if BWOBuildings.IsEventBuilding(building, "party") then 
        canTake = true
        shouldPay = false

    elseif BWOBuildings.IsEventBuilding(building, "home") then 
        canTake = true
        shouldPay = false

    elseif BWORooms.IsShop(room) then
        canTake = false
        shouldPay = true

    elseif BWORooms.IsRestaurant(room) then
        canTake = false
        shouldPay = true

    elseif BWOBuildings.IsResidential(building) then 
        canTake = false
        shouldPay = false

    end

    return canTake, shouldPay
end

BWORooms.GetRoomSize = function(room)
    local roomDef = room:getRoomDef()
    local size = (roomDef:getX2() - roomDef:getX()) * (roomDef:getY2() - roomDef:getY())
    return size
end

BWORooms.GetRoomPopMod = function(room)
    local popMod = 1
    local gameTime = getGameTime()
    local hour = gameTime:getHour()
    local minute = gameTime:getMinutes()
    local building = room:getBuilding()
    local roomName = room:getName()
    
    if BWOBuildings.IsResidential(building) then 
        if hour < 6 then
            popMod = 2
        elseif hour < 17 then
            popMod = 0.5
        elseif hour < 19 then
            popMod = 0.75
        elseif hour < 21 then
            popMod = 1.2
        else
            popMod = 1.6
        end
        if BWOScheduler.SymptomLevel == 1 then
            popMod = 1.2
        elseif BWOScheduler.SymptomLevel == 2 then
            popMod = 1.7
        elseif BWOScheduler.SymptomLevel == 3 then
            popMod = 2
        elseif BWOScheduler.SymptomLevel == 4 then
            popMod = 1.8
        end
    elseif BWORooms.IsStorage(room) then
        popMod = 0.5
    elseif BWORooms.IsShop(room) then
        if hour < 8 then
            popMod = 0
        elseif hour < 10 then
            popMod = 0.7
        elseif hour < 19 then
            popMod = 1.8
        elseif hour < 20 then
            popMod = 0.5
        else
            popMod = 0
        end
        if BWOScheduler.SymptomLevel == 1 then
            popMod = 1.3
        elseif BWOScheduler.SymptomLevel == 2 then
            popMod = 2
        elseif BWOScheduler.SymptomLevel == 3 then
            popMod = 3
        elseif BWOScheduler.SymptomLevel == 4 then
            popMod = 0.8
        end

    elseif BWORooms.IsRestaurant(room) then
        if hour < 8 then
            popMod = 0
        elseif hour < 12 then
            popMod = 0.8
        elseif hour < 14 then
            popMod = 1.6
        elseif hour < 19 then
            popMod = 0.7
        elseif hour < 23 then
            popMod = 2.2
        elseif hour < 24 then
            popMod = 0.8
        end
        if BWOScheduler.SymptomLevel >= 2 then
            popMod = popMod * 0.5
        end
    elseif BWORooms.IsEmpty(room) then
        popMod = 0.1
    elseif BWORooms.IsMedical(room) then
        if BWOScheduler.SymptomLevel == 1 then
            popMod = 1.5
        elseif BWOScheduler.SymptomLevel == 2 then
            popMod = 3
        elseif BWOScheduler.SymptomLevel == 3 then
            popMod = 4
        elseif BWOScheduler.SymptomLevel == 4 then
            popMod = 4.5
        end

    elseif roomName == "church" or roomName == "classroom" then
        if hour < 6 then
            popMod = 0
        elseif hour < 18 then
            popMod = 2
        else
            popMod = 0
        end
        if BWOScheduler.SymptomLevel >= 2 then
            popMod = popMod * 2
        end
    elseif roomName == "hall" then
        popMod = 0.2
    end
    return popMod
end